{# Template for Spring MVC Controller tests with @Mock/@InjectMocks #}
package {{ package_name | default('generated.tests') }};

import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.Mockito.*;
import static org.mockito.ArgumentMatchers.*;
{% for imp in imports_needed %}
{{ imp }}{% if not imp.endswith(';') %};{% endif %}
{% endfor %}

/**
 * Tests for {{ target_class }}.{{ target_name }}
 *
 * Auto-generated by Pipeline Test Agent
 * Uses MockitoExtension for Spring dependency injection testing
 */
@ExtendWith(MockitoExtension.class)
class {{ target_class }}{{ target_name | title | replace('_', '') }}Test {

    // TODO: Add @Mock annotations for injected dependencies
    // Example: @Mock private OwnerRepository owners;

    @InjectMocks
    private {{ target_class }} controller;

    @BeforeEach
    void setUp() {
        // Initialize test data
        // TODO: Setup test objects like testOwner, testPet, etc.
    }

{% for case in test_cases %}
    @Test
    @DisplayName("{{ case.description }}")
    void {{ case.name }}() {
{% for setup_line in case.setup %}
        {{ setup_line }};
{% endfor %}
{% if case.expected.raises %}
        assertThrows({{ case.expected.raises }}.class, () -> {
            controller.{{ target_name }}({% for key, value in case.inputs.items() %}{{ value | safe }}{% if not loop.last %}, {% endif %}{% endfor %});
        });
{% else %}
{% if return_type %}
        var result = controller.{{ target_name }}({% for key, value in case.inputs.items() %}{{ value | safe }}{% if not loop.last %}, {% endif %}{% endfor %});
{% else %}
        controller.{{ target_name }}({% for key, value in case.inputs.items() %}{{ value | safe }}{% if not loop.last %}, {% endif %}{% endfor %});
{% endif %}
{% if case.expected.returns is not none %}
        assertEquals({{ case.expected.returns | safe }}, result);
{% elif return_type %}
        assertNotNull(result);
{% endif %}
{% endif %}
{% for teardown_line in case.teardown %}
        {{ teardown_line }};
{% endfor %}
    }

{% endfor %}
}
